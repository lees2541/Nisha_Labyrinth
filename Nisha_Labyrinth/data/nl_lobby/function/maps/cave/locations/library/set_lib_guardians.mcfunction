#> nl_lobby:maps/cave/locations/library/set_lib_guardians
# 경비병 소환
kill @e[type=wandering_trader,tag=patrol,tag=NL]
kill @e[type=text_display,tag=NL,tag=patrol,tag=gauge_bar]
kill @e[type=interaction,tag=patrol,tag=NL]

## 행상인 1차 passenger가 tag=point 인 코드
#summon wandering_trader 702 39 580 {Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Tags:["NL","lib_guardian","route_a","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_a","star_catch"]},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_a"]},{id:"minecraft:marker",Tags:["NL","patrol","route_a"],data:{tag:"route_a",route:[{point:1},{point:2},{point:3},{point:4}],mode:0}},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_a"],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.51f,0.5f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.51f,0.45f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],CustomName:'{"text":"정찰병"}',Offers:{}}
##
summon wandering_trader 702 39 580 {Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Willing:0b,Tags:["NL","lib_guardian","route_a","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_a","star_catch","tag"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_a","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_a","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_a","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_a","tag"],CustomName:'{"text":"route_a"}',transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_a","tag"]},{id:"minecraft:marker",Tags:["NL","patrol","route_a","tag"],data:{tag:"route_a",route_point:[{point:1},{point:2},{point:3},{point:4}],mode:0}}],CustomName:'{"text":"정찰병"}',attributes:[{id:"minecraft:generic.movement_speed",base:0.81}],Offers:{}}
#summon wandering_trader 702 39 580 {attributes:[{id:generic.movement_speed,base:0.81}],Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Tags:["NL","lib_guardian","route_a","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_a","star_catch"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_a"],CustomName:'{"text":"route_a"}',transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],CustomName:'{"text":"route_a"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_a"]},{id:"minecraft:marker",Tags:["NL","patrol","route_a"],data:{tag:"route_a",route:[{point:1},{point:2},{point:3},{point:4}],mode:0}}],CustomName:'{"text":"정찰병"}',Offers:{}}
#summon wandering_trader 702 39 580 {Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Tags:["NL","lib_guardian","route_a","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_a","star_catch"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_a"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_a"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_a"]},{id:"minecraft:marker",Tags:["NL","patrol","route_a"],data:{tag:"route_a",route:[{point:1},{point:2},{point:3},{point:4}],mode:0}}],CustomName:'{"text":"정찰병"}',Offers:{}}
summon wandering_trader 699.5 40 582.5 {attributes:[{id:generic.movement_speed,base:0.81}],Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Tags:["NL","lib_guardian","route_b","patrol","tag"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_b","star_catch","tag"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_b","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_b","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_b","tag"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_b","tag"],CustomName:'{"text":"route_b"}',transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],CustomName:'{"text":"route_b"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],CustomName:'{"text":"route_b"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],CustomName:'{"text":"route_b"}',brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_b","star_catch","tag"]},{id:"minecraft:marker",Tags:["NL","patrol","route_b","tag"],data:{tag:"route_b",route_point:[{point:5},{point:6},{point:5},{point:7},{point:1},{point:8},{point:1},{point:4}],mode:0}}],CustomName:'{"text":"정찰병"}',Offers:{}}
#summon wandering_trader 699.5 40 582.5 {Silent:1b,Invulnerable:1b,Glowing:0b,CustomNameVisible:0b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Tags:["NL","lib_guardian","route_b","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_b","star_catch"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_b"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_b"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_b"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_b"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_b"]},{id:"minecraft:marker",Tags:["NL","patrol","route_b"],data:{tag:"route_b",route:[{point:5},{point:6},{point:5},{point:7},{point:1},{point:8},{point:1},{point:4}],mode:0}}],CustomName:'{"text":"정찰병"}',Offers:{}}
execute as @e[type=wandering_trader,tag=patrol,tag=NL] at @s run function nl_lobby:modules/entity_route/set_route_pos with entity @s Passengers[{id:"minecraft:marker"}].data

#summon wandering_trader 688.5 40 582.5 {Silent:1b,Invulnerable:1b,Glowing:1b,CustomNameVisible:1b,Team:"NL_ex_only",PersistenceRequired:1b,CanPickUpLoot:0b,Willing:0b,Tags:["NL","lib_guardian","route_B","patrol"],Passengers:[{id:"minecraft:interaction",width:1f,height:-1.6f,response:1b,Tags:["NL","patrol","route_B"]},{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","background","route_B"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section1","route_B"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",alignment:"center",Tags:["NL","patrol","gauge_bar","section","section2","route_B"],Passengers:[{id:"minecraft:text_display",view_range:0.1f,billboard:"center",see_through:1b,alignment:"center",Tags:["NL","patrol","gauge_bar","point","route_B"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.4f],scale:[0.5f,0.4f,1f]},text:'{"text":"!"}',background:-65536}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.399f],scale:[1f,0.4f,1f]},text:'{"text":" "}',background:-1610557953}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.398f],scale:[1f,0.4f,1f]},text:'{"text":"    "}',background:2020476679}],brightness:{sky:15,block:10},transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],translation:[0f,0.5f,0.397f],scale:[1f,0.4f,1f]},text:'{"text":"        "}',background:-1121244630},{id:"minecraft:interaction",width:1f,height:0.7f,response:1b,Tags:["NL","patrol","route_B"]}],CustomName:'{"text":"정찰병"}',wander_target:{X:692,Y:35,Z:594},Offers:{}}

tag @e[type=text_display,tag=gauge_bar,tag=point] add right
execute as @e[type=text_display,tag=gauge_bar,tag=point] run function nl_system:modules/star_catch/point_moving/left/left


scoreboard players set @e[type=text_display,tag=gauge_bar,tag=point] NL_timer 0


scoreboard players set @e[type=wandering_trader,tag=route_a,tag=patrol] NL_mode 0
scoreboard players set @e[type=wandering_trader,tag=route_b,tag=patrol] NL_mode 5
